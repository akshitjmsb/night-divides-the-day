<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Money - Night Divides the Day</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Special+Elite&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="src/styles/index.css">
    
    <script type="importmap">
    {
      "imports": {
        "@google/genai": "https://esm.sh/@google/genai"
      }
    }
    </script>
</head>
<body>
    <div id="app-container" class="app-container">
        <!-- Header -->
        <header class="text-center mb-6">
            <div class="logo-container flex justify-center">
                <svg class="logo-svg" viewBox="0 0 100 80" xmlns="http://www.w3.org/2000/svg">
                    <title>Night Divides the Day Logo</title>
                    <path d="M70,35 C 72,50 68,65 65,68" />
                    <path d="M60,25 C 62,45 58,68 55,70" />
                    <path d="M50,23 C 52,43 48,70 45,72" />
                    <path d="M40,28 C 42,48 38,68 35,70" />
                </svg>
            </div>
            <div class="flex justify-center items-center">
                <h1>Money Tracker</h1>
                <span class="theme-icon">üí∞</span>
            </div>
            <p class="text-xs mt-2">Financial awareness and budgeting</p>
        </header>

        <!-- Navigation -->
        <nav class="text-center mb-6">
            <a href="index.html" class="todo-toggle-button">
                <h2>‚Üê Back to Dashboard</h2>
            </a>
        </nav>

        <!-- Financial Overview -->
        <section class="mobile-section">
            <h2 class="text-center mb-4">Financial Overview</h2>
            <div class="grid grid-cols-2 gap-4 mb-4">
                <div class="bg-green-100 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-green-700" id="total-income">$0</div>
                    <div class="text-sm text-green-600">Total Income</div>
                </div>
                <div class="bg-red-100 p-4 rounded-lg text-center">
                    <div class="text-2xl font-bold text-red-700" id="total-expenses">$0</div>
                    <div class="text-sm text-red-600">Total Expenses</div>
                </div>
            </div>
            <div class="bg-blue-100 p-4 rounded-lg text-center">
                <div class="text-2xl font-bold text-blue-700" id="net-amount">$0</div>
                <div class="text-sm text-blue-600">Net Amount</div>
            </div>
        </section>

        <!-- Quick Actions -->
        <section class="mobile-section">
            <h2 class="text-center mb-4">Quick Actions</h2>
            <div class="grid grid-cols-1 gap-3">
                <button class="todo-toggle-button" id="add-income-btn">
                    <h2>+ Add Income</h2>
                </button>
                <button class="todo-toggle-button" id="add-expense-btn">
                    <h2>- Add Expense</h2>
                </button>
                <button class="todo-toggle-button" id="view-transactions-btn">
                    <h2>View Transactions</h2>
                </button>
            </div>
        </section>

        <!-- Recent Transactions -->
        <section class="mobile-section">
            <h2 class="text-center mb-4">Recent Transactions</h2>
            <div id="transactions-list" class="space-y-2">
                <div class="text-center text-gray-500 text-sm">
                    No transactions yet. Add your first income or expense!
                </div>
            </div>
        </section>
    </div>

    <script type="module" src="src/index.tsx"></script>
    <script>
        // Money page specific functionality
        document.addEventListener('DOMContentLoaded', () => {
            let transactions = JSON.parse(localStorage.getItem('money-transactions') || '[]');
            
            const totalIncomeEl = document.getElementById('total-income');
            const totalExpensesEl = document.getElementById('total-expenses');
            const netAmountEl = document.getElementById('net-amount');
            const transactionsListEl = document.getElementById('transactions-list');
            const addIncomeBtn = document.getElementById('add-income-btn');
            const addExpenseBtn = document.getElementById('add-expense-btn');
            const viewTransactionsBtn = document.getElementById('view-transactions-btn');

            function updateFinancialOverview() {
                const totalIncome = transactions
                    .filter(t => t.type === 'income')
                    .reduce((sum, t) => sum + t.amount, 0);
                
                const totalExpenses = transactions
                    .filter(t => t.type === 'expense')
                    .reduce((sum, t) => sum + t.amount, 0);
                
                const netAmount = totalIncome - totalExpenses;

                totalIncomeEl.textContent = `$${totalIncome.toFixed(2)}`;
                totalExpensesEl.textContent = `$${totalExpenses.toFixed(2)}`;
                netAmountEl.textContent = `$${netAmount.toFixed(2)}`;
                
                // Color code net amount
                if (netAmount > 0) {
                    netAmountEl.className = 'text-2xl font-bold text-green-700';
                } else if (netAmount < 0) {
                    netAmountEl.className = 'text-2xl font-bold text-red-700';
                } else {
                    netAmountEl.className = 'text-2xl font-bold text-blue-700';
                }
            }

            function addTransaction(type, amount, description) {
                const transaction = {
                    id: Date.now(),
                    type: type,
                    amount: parseFloat(amount),
                    description: description,
                    date: new Date().toISOString()
                };
                
                transactions.unshift(transaction);
                localStorage.setItem('money-transactions', JSON.stringify(transactions));
                updateFinancialOverview();
                updateTransactionsList();
            }

            function updateTransactionsList() {
                if (transactions.length === 0) {
                    transactionsListEl.innerHTML = `
                        <div class="text-center text-gray-500 text-sm">
                            No transactions yet. Add your first income or expense!
                        </div>
                    `;
                    return;
                }

                transactionsListEl.innerHTML = transactions.slice(0, 5).map(transaction => `
                    <div class="bg-gray-100 p-3 rounded-lg text-sm">
                        <div class="flex justify-between items-center">
                            <div>
                                <div class="font-semibold">${transaction.description}</div>
                                <div class="text-gray-600">${new Date(transaction.date).toLocaleDateString()}</div>
                            </div>
                            <div class="text-right">
                                <div class="font-bold ${transaction.type === 'income' ? 'text-green-700' : 'text-red-700'}">
                                    ${transaction.type === 'income' ? '+' : '-'}$${transaction.amount.toFixed(2)}
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            function promptForTransaction(type) {
                const amount = prompt(`Enter ${type} amount:`);
                if (!amount || isNaN(amount) || parseFloat(amount) <= 0) {
                    alert('Please enter a valid amount.');
                    return;
                }
                
                const description = prompt(`Enter description for this ${type}:`);
                if (!description) {
                    alert('Please enter a description.');
                    return;
                }
                
                addTransaction(type, amount, description);
            }

            addIncomeBtn.addEventListener('click', () => promptForTransaction('income'));
            addExpenseBtn.addEventListener('click', () => promptForTransaction('expense'));
            
            viewTransactionsBtn.addEventListener('click', () => {
                if (transactions.length === 0) {
                    alert('No transactions to view yet.');
                    return;
                }
                
                const allTransactions = transactions.map(t => 
                    `${t.type.toUpperCase()}: $${t.amount.toFixed(2)} - ${t.description} (${new Date(t.date).toLocaleDateString()})`
                ).join('\n');
                
                alert(`All Transactions:\n\n${allTransactions}`);
            });

            // Initialize
            updateFinancialOverview();
            updateTransactionsList();
        });
    </script>
</body>
</html>
